function HeatmapOverlay(a,e){this.heatmap=null;this.conf=e;this.latlngs=[];this.bounds=null;this.setMap(a)}HeatmapOverlay.prototype=new google.maps.OverlayView;HeatmapOverlay.prototype.onAdd=function(){var a=this.getPanes(),e=this.getMap().getDiv().clientWidth,c=this.getMap().getDiv().clientHeight,b=document.createElement("div");b.style.cssText="position:absolute;top:0;left:0;width:"+e+"px;height:"+c+"px;";this.conf.element=b;a.overlayLayer.appendChild(b);this.heatmap=h337.create(this.conf)};
HeatmapOverlay.prototype.onRemove=function(){};
HeatmapOverlay.prototype.draw=function(){var a=this.getProjection(),e=this.map.getBounds();if(!e.equals(this.bounds)){this.bounds=e;var c=a.fromLatLngToDivPixel(e.getNorthEast()),b=a.fromLatLngToDivPixel(e.getSouthWest()),a=c.y,g=b.x,f=b.y-c.y,c=c.x-b.x;this.conf.element.style.left=g+"px";this.conf.element.style.top=a+"px";this.conf.element.style.width=c+"px";this.conf.element.style.height=f+"px";this.heatmap.store.get("heatmap").resize();if(0<this.latlngs.length){this.heatmap.clear();c=this.latlngs.length;
f=this.getProjection();for(d={max:this.heatmap.store.max,data:[]};c--;)b=this.latlngs[c].latlng,e.contains(b)&&(b=f.fromLatLngToDivPixel(b),b=new google.maps.Point(b.x-g,b.y-a),b=this.pixelTransform(b),d.data.push({x:b.x,y:b.y,count:this.latlngs[c].c}));this.heatmap.store.setDataSet(d)}}};HeatmapOverlay.prototype.pixelTransform=function(a){for(var e=this.heatmap.get("width"),c=this.heatmap.get("height");0>a.x;)a.x+=e;for(;a.x>e;)a.x-=e;for(;0>a.y;)a.y+=c;for(;a.y>c;)a.y-=c;a.x>>=0;a.y>>=0;return a};
HeatmapOverlay.prototype.setDataSet=function(a){var e=this.map.getBounds(),c={max:a.max,data:[]};a=a.data;var b=a.length,g=this.getProjection(),f;for(this.latlngs=[];b--;)f=new google.maps.LatLng(a[b].lat,a[b].lng),e.contains(f)&&(this.latlngs.push({latlng:f,c:a[b].count}),f=this.pixelTransform(g.fromLatLngToDivPixel(f)),c.data.push({x:f.x,y:f.y,count:a[b].count}));this.heatmap.clear();this.heatmap.store.setDataSet(c)};
HeatmapOverlay.prototype.addDataPoint=function(a,e,c){var b=this.getProjection();a=new google.maps.LatLng(a,e);b=this.pixelTransform(b.fromLatLngToDivPixel(a));this.heatmap.store.addDataPoint(b.x,b.y,c);this.latlngs.push({latlng:a,c:c})};HeatmapOverlay.prototype.toggle=function(){this.heatmap.toggleDisplay()};